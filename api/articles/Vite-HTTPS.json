{"title":"Vite åœ¨å¼€å‘æ¨¡å¼ä½¿ç”¨ HTTPS","uid":"4463bcb580e6af97fe7a8a01ae296a7e","slug":"Vite-HTTPS","date":"2021-06-21T03:06:53.000Z","updated":"2021-06-22T10:16:30.101Z","comments":true,"path":"api/articles/Vite-HTTPS.json","keywords":"ğŸ‘¨â€ğŸ’»ğŸ¸ğŸº","cover":null,"content":"<p>åœ¨ä½¿ç”¨ Vite è¿›è¡Œå‰ç«¯å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶éœ€è¦æ¨¡æ‹Ÿä¸€ä¸‹ HTTPS çš„ç¯å¢ƒï¼ˆæ¯”å¦‚å¼€å¯ PWAï¼‰ï¼Œä½†æ˜¯å¦‚æœç›´æ¥è®¾ç½®<code>server.https = true</code>ï¼Œæµè§ˆå™¨ä¼šæŠ¥<strong>æ‚¨çš„è¿æ¥ä¸æ˜¯ç§å¯†è¿æ¥</strong>è¿™æ ·çš„è­¦å‘Šï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p>\n<p>ä»”ç»†çš„æŸ¥çœ‹äº†ä¸‹æ–‡æ¡£ï¼Œå‘ç°å·²ç»è¯´çš„å¾ˆæ¸…æ™°äº†<code>server.https</code>è¿™ä¸ªå€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªä¼ é€’ç»™ <code>https.createServer()</code> çš„ <a href=\"https://nodejs.org/api/https.html#https_https_createserver_options_requestlistener\">é€‰é¡¹å¯¹è±¡</a>ã€‚ä¸‹é¢æ˜¯ç¤ºä¾‹</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">&#x2F;&#x2F; curl -k https:&#x2F;&#x2F;localhost:8000&#x2F;\nconst https &#x3D; require(&#39;https&#39;)\nconst fs &#x3D; require(&#39;fs&#39;)\n\nconst options &#x3D; &#123;\n  key: fs.readFileSync(&#39;test&#x2F;fixtures&#x2F;keys&#x2F;agent2-key.pem&#39;),\n  cert: fs.readFileSync(&#39;test&#x2F;fixtures&#x2F;keys&#x2F;agent2-cert.pem&#39;)\n&#125;\n\nhttps\n  .createServer(options, (req, res) &#x3D;&gt; &#123;\n    res.writeHead(200)\n    res.end(&#39;hello world\\n&#39;)\n  &#125;)\n  .listen(8000)</code></pre>\n\n<p>æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠ <code>options</code> èµ‹å€¼ç»™ <code>server.https</code>ã€‚å½“ç„¶è¿˜éœ€è¦å€ŸåŠ©å·¥å…·å»ç”Ÿæˆ key å’Œ certã€‚</p>\n<h2 id=\"æ“ä½œæ­¥éª¤\"><a href=\"#æ“ä½œæ­¥éª¤\" class=\"headerlink\" title=\"æ“ä½œæ­¥éª¤\"></a>æ“ä½œæ­¥éª¤</h2><ol>\n<li><p>å®‰è£… <a href=\"https://github.com/FiloSottile/mkcert\">mkcert</a></p>\n<p>æˆ‘ä½¿ç”¨çš„æ˜¯ Win10ï¼Œå°±ä½¿ç”¨ choco æ¥å®‰è£…äº†</p>\n<pre class=\"line-numbers language-powershell\" data-language=\"powershell\"><code class=\"language-powershell\">choco install mkcert</code></pre>\n</li>\n<li><p>ç”Ÿæˆ key å’Œ cert</p>\n<p>ä¸ºäº†ä¾¿äºç®¡ç†æˆ‘åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºäº† ssl æ–‡ä»¶å¤¹</p>\n<pre class=\"line-numbers language-powershell\" data-language=\"powershell\"><code class=\"language-powershell\">mkdir ssl\ncd ssl\nmkcert localhost</code></pre>\n\n<p>æ“ä½œå®Œæˆåä½ ä¼šå‘ç° ssl ç›®å½•ä¸‹å¤šäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ key å’Œ cert</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ssl\nâ”œâ”€â”€ localhost-key.pem\nâ””â”€â”€ localhost.pem</code></pre>\n</li>\n<li><p>é…ç½® vite.config.js</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">import &#123; defineConfig &#125; from &#39;vite&#39;\nimport path from &#39;path&#39;\nimport fs from &#39;fs&#39;\n\nexport default defineConfig(&#123;\n  server: &#123;\n    https: &#123;\n      key: fs.readFileSync(path.resolve(__dirname, &#39;.&#x2F;ssl&#x2F;localhost-key.pem&#39;)),\n      cert: fs.readFileSync(path.resolve(__dirname, &#39;.&#x2F;ssl&#x2F;localhost.pem&#39;))\n    &#125;\n  &#125;\n&#125;)</code></pre>\n\n<p>ä¸‹æ¬¡åœ¨å¯åŠ¨å°±èƒ½çœ‹åˆ°åœ°å€æ ä¸Šçš„å°é”å¤´äº† ğŸ”’</p>\n</li>\n</ol>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://penueling.com/%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/%E8%A6%81%E6%80%8E%E9%BA%BC%E8%AE%93localhost%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%9C%89https%E6%86%91%E8%AD%89%EF%BC%9F/\">[vite è¦æ€éº¼è®“ localhost ä¹Ÿå¯ä»¥æœ‰ https æ†‘è­‰ï¼Ÿ](https://penueling.com/æŠ€è¡“ç­†è¨˜/è¦æ€éº¼è®“ localhost ä¹Ÿå¯ä»¥æœ‰ https æ†‘è­‰ï¼Ÿ/)</a></p></blockquote>\n","text":"åœ¨ä½¿ç”¨ Vite è¿›è¡Œå‰ç«¯å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶éœ€è¦æ¨¡æ‹Ÿä¸€ä¸‹ HTTPS çš„ç¯å¢ƒï¼ˆæ¯”å¦‚å¼€å¯ PWAï¼‰ï¼Œä½†æ˜¯å¦‚æœç›´æ¥è®¾ç½®server.https = trueï¼Œæµè§ˆå™¨ä¼šæŠ¥æ‚¨çš„è¿æ¥ä¸æ˜¯ç§å¯†è¿æ¥è¿™æ ·çš„è­¦å‘Šï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ ä»”ç»†çš„æŸ¥çœ‹äº†ä¸‹æ–‡æ¡£ï¼Œå‘ç°å·²ç»è¯´çš„å¾ˆæ¸…æ™°äº†server.httpsè¿™...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","count":17,"path":"api/categories/å‰ç«¯.json"}],"tags":[{"name":"Vite","slug":"Vite","count":1,"path":"api/tags/Vite.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4\"><span class=\"toc-text\">æ“ä½œæ­¥éª¤</span></a></li></ol>","author":{"name":"ZV","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"è‡´è¿‡å»çš„æ—¶å…‰","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"Cæ•°æ®ç±»å‹","uid":"91073ca00ced3eaf093ce066e8170e85","slug":"Cæ•°æ®ç±»å‹","date":"2021-06-18T02:52:41.000Z","updated":"2021-06-22T10:16:30.101Z","comments":true,"path":"api/articles/Cæ•°æ®ç±»å‹.json","keywords":"ğŸ‘¨â€ğŸ’»ğŸ¸ğŸº","cover":null,"text":"æ•´å‹#include &lt;limits.h&gt; #include &lt;math.h&gt; #include &lt;stdio.h&gt; int main( int argc, char* argv[] ) &#123; &#x2F;* æœ‰ç¬¦å·æ•´å½¢ *&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":"6.5k","symbolsTime":"6 mins."},"categories":[{"name":"æ‹“å±•","slug":"æ‹“å±•","count":10,"path":"api/categories/æ‹“å±•.json"}],"tags":[{"name":"C","slug":"C","count":2,"path":"api/tags/C.json"}],"author":{"name":"ZV","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"è‡´è¿‡å»çš„æ—¶å…‰","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}