{"title":"è¯•è¯• Proxy å’Œ Reflect","uid":"391e5379613c514b7c0c8a55534d752c","slug":"è¯•è¯• Proxy å’Œ Reflect","date":"2020-08-26T00:00:00.000Z","updated":"2021-06-22T10:16:30.101Z","comments":true,"path":"api/articles/è¯•è¯• Proxy å’Œ Reflect.json","keywords":"ğŸ‘¨â€ğŸ’»ğŸ¸ğŸº","cover":null,"content":"<h2 id=\"Proxy\"><a href=\"#Proxy\" class=\"headerlink\" title=\"Proxy\"></a>Proxy</h2><p>ä½¿ç”¨ <code>Object.defineProperty()</code>æ¨¡æ‹Ÿ<code>Vue</code>çš„æ•°æ®ç»‘å®š</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">class VData &#123;\n  constructor(&#123; data &#125;) &#123;\n    this.data &#x3D; data\n    this.bindData(data)\n  &#125;\n  bindData(data) &#123;\n    const newData &#x3D; &#123;&#125;\n    for (const key in data) &#123;\n      if (data.hasOwnProperty(key)) &#123;\n        newData[key] &#x3D; data[key]\n        Object.defineProperty(data, key, &#123;\n          get() &#123;\n            return newData[key]\n          &#125;,\n          set(val) &#123;\n            newData[key] &#x3D; val\n          &#125;\n        &#125;)\n      &#125;\n    &#125;\n  &#125;\n&#125;\nconst v &#x3D; new VData(&#123;\n  data: &#123;\n    a: 1,\n    b: 2\n  &#125;\n&#125;)</code></pre>\n\n<p>ä½¿ç”¨<code>Proxy</code>å°è£…ä¸€ä¸ªå¯è®¾ç½®ç±»å‹çš„æ•°ç»„<code>TypeArray</code>ï¼Œå¹¶ä¸”å¯¹æ•°ç»„ä¸­ä¸å­˜åœ¨çš„å€¼è¿”å›é»˜è®¤å€¼</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">const TypeArray &#x3D; (type, defaultValue &#x3D; &#39;N&#x2F;A&#39;, initArray &#x3D; []) &#x3D;&gt; &#123;\n  return new Proxy(initArray, &#123;\n    get(target, prop) &#123;\n      return target[prop] || defaultValue\n    &#125;,\n    set(target, prop, value) &#123;\n      if (typeof value &#x3D;&#x3D;&#x3D; type || prop &#x3D;&#x3D;&#x3D; &#39;length&#39;) &#123;\n        target[prop] &#x3D; value\n        return true\n      &#125; else &#123;\n        return false\n      &#125;\n    &#125;\n  &#125;)\n&#125;\n\nconst numArr &#x3D; TypeArray(&#39;number&#39;)\nnumArr.push(1)   &#x2F;&#x2F; Proxy ä»£ç†æ•°ç»„ æ•°ç»„æœ¬èº«çš„æ–¹æ³•å±æ€§ä¸ä¼šè¢«ç ´å\nnumArr.push(&quot;2&quot;) &#x2F;&#x2F; Uncaught TypeError: &#39;set&#39; on proxy: trap returned falsish for property &#39;2&#39; at Proxy.push (&lt;anonymous&gt;)</code></pre>\n\n<p>ä½¿ç”¨ <code>has</code>æ–¹æ³•æ•è·<code>in</code>æ“ä½œç¬¦</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">const checkRange &#x3D; new Proxy(\n  &#123;\n    start: 0,\n    end: 100\n  &#125;,\n  &#123;\n    has(target, prop) &#123;\n      return prop &gt;&#x3D; target.start &amp;&amp; prop &lt;&#x3D; target.end\n    &#125;\n  &#125;\n)\n\nconsole.log(50 in checkRange)\t&#x2F;&#x2F; false\nconsole.log(150 in checkRange)\t&#x2F;&#x2F; true</code></pre>\n\n<p>ä½¿ç”¨<code>ownKeys</code>æ‹¦æˆª <code>Reflect.ownKeys()</code>ä¹Ÿå¯ä»¥æ‹¦æˆª <code>Object.keys() ; for in Loop ; Object.getOwnPropertySymbols()</code> ä¸­çš„éƒ¨åˆ†çš„ key </p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">const obj &#x3D; &#123;\n  attr: &#39;attr&#39;,\n  _attr: &#39;_attr&#39;,\n  [Symbol(&#39;attr&#39;)]: &#39;Symbol(attr)&#39;,\n  [Symbol(&#39;_attr&#39;)]: &#39;Symbol(_attr)&#39;\n&#125;\n\n&#x2F;&#x2F; æœªä½¿ç”¨ Proxy çš„ ownKeys æ‹¦æˆª\nconsole.log(Object.keys(obj)) &#x2F;&#x2F; [&quot;attr&quot;, &quot;_attr&quot;]\nconsole.log(Object.getOwnPropertySymbols(obj)) &#x2F;&#x2F;Â [Symbol(attr), Symbol(_attr)]\nconsole.log(Reflect.ownKeys(obj)) &#x2F;&#x2F; [&quot;attr&quot;, &quot;_attr&quot;, Symbol(attr), Symbol(_attr)]\nfor (const key in obj) &#123;\n  console.log(key) &#x2F;&#x2F; attr _attr\n&#125;\n\n&#x2F;&#x2F; ä½¿ç”¨ Proxy çš„ ownKeys æ‹¦æˆª\nconst p &#x3D; new Proxy(obj, &#123;\n  ownKeys(target) &#123;\n    const normalKeys &#x3D; Object.keys(target)\n    const normalFilterKeys &#x3D; normalKeys.filter((key) &#x3D;&gt; !key.startsWith(&#39;_&#39;)) &#x2F;&#x2F; æ‹¦æˆªä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„ key\n    const symbolKeys &#x3D; Object.getOwnPropertySymbols(target)\n    const symbolFilterKeys &#x3D; symbolKeys.filter((key) &#x3D;&gt; !key.toString().startsWith(&#39;Symbol(_&#39;)) &#x2F;&#x2F; æ‹¦æˆªä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„ key\n    return [...normalFilterKeys, ...symbolFilterKeys]\n  &#125;\n&#125;)\n\nconsole.log(Object.keys(p)) &#x2F;&#x2F; [&quot;attr&quot;]\nconsole.log(Object.getOwnPropertySymbols(p)) &#x2F;&#x2F;Â [Symbol(attr)]\nconsole.log(Reflect.ownKeys(p)) &#x2F;&#x2F; [&quot;attr&quot;, Symbol(attr)]\nfor (const key in p) &#123;\n  console.log(key) &#x2F;&#x2F; attr\n&#125;</code></pre>\n\n<p>æ¥ä¸ªç»¼åˆæ¡ˆä¾‹</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">const userInfo &#x3D; &#123;\n  name: &#39;Jack&#39;,\n  age: 17,\n  _address: &#39;London UK&#39;\n&#125;\n\nconst p &#x3D; new Proxy(userInfo, &#123;\n  get(target, prop) &#123;\n    if (prop.startsWith(&#39;_&#39;)) &#123;\n      throw new Error(&#96;$&#123;prop&#125; ä¸å¯è®¿é—®&#96;)\n    &#125; else &#123;\n      return target[prop] || &#39;N&#x2F;A&#39;\n    &#125;\n  &#125;,\n  set(target, prop, value) &#123;\n    if (prop.startsWith(&#39;_&#39;)) &#123;\n      throw new Error(&#96;ä¸èƒ½è®¾ç½® $&#123;prop&#125;&#96;)\n    &#125; else &#123;\n      target[prop] &#x3D; value\n      return true\n    &#125;\n  &#125;,\n  deleteProperty(target, prop) &#123;\n    if (prop.startsWith(&#39;_&#39;)) &#123;\n      throw new Error(&#96;ä¸èƒ½åˆ é™¤$&#123;prop&#125;&#96;)\n    &#125; else &#123;\n      delete target[prop]\n      return true\n    &#125;\n  &#125;,\n  ownKeys(target) &#123;\n    return Object.keys(target).filter((key) &#x3D;&gt; !key.startsWith(&#39;_&#39;))\n  &#125;\n&#125;)</code></pre>\n\n<p>ä½¿ç”¨ <code>apply</code>æ‹¦æˆªå‡½æ•°çš„è°ƒç”¨ï¼ˆåŒ…è£…å‡½æ•°ï¼‰</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">const sum &#x3D; (a, b) &#x3D;&gt; &#123;\n  return a + b\n&#125;\n\nconst sumText &#x3D; new Proxy(sum, &#123;\n  apply(target, thisArg, argArray) &#123;\n    return &#96;total number is $&#123;target(...argArray)&#125;&#96;\n  &#125;\n&#125;)\n\nsumText(10, 20)</code></pre>\n\n","text":"Proxyä½¿ç”¨ Object.defineProperty()æ¨¡æ‹ŸVueçš„æ•°æ®ç»‘å®š class VData &#123; constructor(&#123; data &#125;) &#123; this.data &#x3D; data this.bindData(data...","link":"","photos":[],"count_time":{"symbolsCount":"4.6k","symbolsTime":"4 mins."},"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","count":17,"path":"api/categories/å‰ç«¯.json"}],"tags":[{"name":"JavaScript","slug":"JavaScript","count":14,"path":"api/tags/JavaScript.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Proxy\"><span class=\"toc-text\">Proxy</span></a></li></ol>","author":{"name":"ZV","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"è‡´è¿‡å»çš„æ—¶å…‰","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ä½¿ç”¨nvmç®¡ç†Node.jsç‰ˆæœ¬","uid":"923873964bedc6d39520ffd3396ca0ce","slug":"ä½¿ç”¨nvmç®¡ç†Node-jsç‰ˆæœ¬","date":"2021-01-07T17:12:09.000Z","updated":"2021-06-22T10:16:30.101Z","comments":true,"path":"api/articles/ä½¿ç”¨nvmç®¡ç†Node-jsç‰ˆæœ¬.json","keywords":"ğŸ‘¨â€ğŸ’»ğŸ¸ğŸº","cover":null,"text":"èƒŒæ™¯åœ¨å®éªŒ Vue3 çš„æ—¶å€™ï¼Œæç¤º Error: Cannot find module &#39;vue-loader-v16/package.json&#39;ï¼Œæ’æŸ¥åå‘ç°æ˜¯Node.js npmçš„é—®é¢˜äºæ˜¯å®‰è£…äº†æœ€æ–°çš„ 14.15.4 LTSï¼Œä½†æ˜¯åœ¨è§£å†³å®Œ Vue3çš„é—®é¢˜åï¼Œä½¿...","link":"","photos":[],"count_time":{"symbolsCount":681,"symbolsTime":"1 mins."},"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","count":17,"path":"api/categories/å‰ç«¯.json"}],"tags":[{"name":"Node.js","slug":"Node-js","count":2,"path":"api/tags/Node-js.json"}],"author":{"name":"ZV","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"è‡´è¿‡å»çš„æ—¶å…‰","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"å¤ä¹ ä¸€ä¸‹Generatorçš„ä½¿ç”¨","uid":"c1e7e740a56d87809715d43780d153ea","slug":"å¤ä¹ ä¸€ä¸‹Generatorçš„ä½¿ç”¨","date":"2020-08-25T00:00:00.000Z","updated":"2021-06-22T10:16:30.101Z","comments":true,"path":"api/articles/å¤ä¹ ä¸€ä¸‹Generatorçš„ä½¿ç”¨.json","keywords":"ğŸ‘¨â€ğŸ’»ğŸ¸ğŸº","cover":null,"text":"å…ˆæ¥ä¸ªä¾‹é¢˜ çœ‹ä¸€ä¸‹ç»“æœ function* addGen(x) &#123; let y &#x3D; (yield x + 5) * 2 let z &#x3D; yield y &#x2F; 4 return x + y + z &#125; let g &#x3D; add...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","count":17,"path":"api/categories/å‰ç«¯.json"}],"tags":[{"name":"JavaScript","slug":"JavaScript","count":14,"path":"api/tags/JavaScript.json"}],"author":{"name":"ZV","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"è‡´è¿‡å»çš„æ—¶å…‰","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}